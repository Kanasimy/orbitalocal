(function(b){b.HSCore.components.HSCountdown={_baseConfig:{yearsElSelector:".years",monthElSelector:".month",daysElSelector:".days",hoursElSelector:".hours",minutesElSelector:".minutes",secondsElSelector:".seconds",circles:false,wrpClass:"wrpClass",textClass:"textClass",valueStrokeClass:"valueStrokeClass",maxValueStrokeClass:"maxValueStrokeClass",styleWrapper:"styleWrapper",styleText:"styleText"},pageCollection:b(),_circlesIds:[0],init:function(a,d){this.collection=a&&b(a).length?b(a):b();if(!b(a).length){return}this.config=d&&b.isPlainObject(d)?b.extend({},this._baseConfig,d):this._baseConfig;this.config.itemSelector=a;this.initCountdowns();return this.pageCollection},initCountdowns:function(){var a=this;this.collection.each(function(i,h){var g=b(h),j={endDate:g.attr("data-end-date")?(!isNaN(+g.attr("data-end-date"))?new Date(+g.attr("data-end-date")):new Date(g.attr("data-end-date"))):new Date(),startDate:g.data("start-date")?new Date(g.data("start-date")):new Date(),yearsEl:g.find(a.config.yearsElSelector),yearsFormat:g.data("years-format"),monthEl:g.find(a.config.monthElSelector),monthFormat:g.data("month-format"),daysEl:g.find(a.config.daysElSelector),daysFormat:g.data("days-format"),hoursEl:g.find(a.config.hoursElSelector),hoursFormat:g.data("hours-format"),minutesEl:g.find(a.config.minutesElSelector),minutesFormat:g.data("minutes-format"),secondsEl:g.find(a.config.secondsElSelector),secondsFormat:g.data("seconds-format")};if(a.config.circles&&g.data("start-date")){a._initPiesImplementation(g,j)}else{a._initBaseImplementation(g,j)}a.pageCollection=a.pageCollection.add(g)})},_initBaseImplementation:function(a,d){a.countdown(d.endDate,function(c){if(d.yearsEl.length){d.yearsEl.text(c.strftime(d.yearsFormat))}if(d.monthEl.length){d.monthEl.text(c.strftime(d.monthFormat))}if(d.daysEl.length){d.daysEl.text(c.strftime(d.daysFormat))}if(d.hoursEl.length){d.hoursEl.text(c.strftime(d.hoursFormat))}if(d.minutesEl.length){d.minutesEl.text(c.strftime(d.minutesFormat))}if(d.secondsEl.length){d.secondsEl.text(c.strftime(d.secondsFormat))}})},_initPiesImplementation:function(a,i){var j=this,g,h=24*60*60*1000;if(i.yearsEl.length){j._preparePieItem(i.yearsEl,{maxValue:(i.endDate.getFullYear()-i.startDate.getFullYear()),radius:a.data("circles-radius"),width:a.data("circles-stroke-width"),"fg-color":a.data("circles-fg-color"),"bg-color":a.data("circles-bg-color"),"additional-text":a.data("circles-additional-text"),"font-size":a.data("circles-font-size")})}if(i.monthEl.length){j._preparePieItem(i.monthEl,{maxValue:Math.round(Math.abs((i.endDate.getTime()-i.startDate.getTime())/(h)))/12,radius:a.data("circles-radius"),width:a.data("circles-stroke-width"),"fg-color":a.data("circles-fg-color"),"bg-color":a.data("circles-bg-color"),"additional-text":a.data("circles-additional-text"),"font-size":a.data("circles-font-size")})}if(i.daysEl.length){j._preparePieItem(i.daysEl,{maxValue:j._getDaysMaxValByFormat(i.daysFormat,i.startDate,i.endDate),radius:a.data("circles-radius"),width:a.data("circles-stroke-width"),"fg-color":a.data("circles-fg-color"),"bg-color":a.data("circles-bg-color"),"additional-text":a.data("circles-additional-text"),"font-size":a.data("circles-font-size")})}if(i.hoursEl.length){j._preparePieItem(i.hoursEl,{maxValue:60,radius:a.data("circles-radius"),width:a.data("circles-stroke-width"),"fg-color":a.data("circles-fg-color"),"bg-color":a.data("circles-bg-color"),"additional-text":a.data("circles-additional-text"),"font-size":a.data("circles-font-size")})}if(i.minutesEl.length){j._preparePieItem(i.minutesEl,{maxValue:60,radius:a.data("circles-radius"),width:a.data("circles-stroke-width"),"fg-color":a.data("circles-fg-color"),"bg-color":a.data("circles-bg-color"),"additional-text":a.data("circles-additional-text"),"font-size":a.data("circles-font-size")})}if(i.secondsEl.length){j._preparePieItem(i.secondsEl,{maxValue:60,radius:a.data("circles-radius"),width:a.data("circles-stroke-width"),"fg-color":a.data("circles-fg-color"),"bg-color":a.data("circles-bg-color"),"additional-text":a.data("circles-additional-text"),"font-size":a.data("circles-font-size")})}a.countdown(i.endDate,function(c){if(i.yearsEl.length){i.yearsEl.data("circle").update(c.strftime(i.yearsFormat))}if(i.monthEl.length){i.monthEl.data("circle").update(c.strftime(i.monthFormat))}if(i.daysEl.length){i.daysEl.data("circle").update(c.strftime(i.daysFormat))}if(i.hoursEl.length){i.hoursEl.data("circle").update(c.strftime(i.hoursFormat))}if(i.minutesEl.length){i.minutesEl.data("circle").update(c.strftime(i.minutesFormat))}if(i.secondsEl.length){i.secondsEl.data("circle").update(c.strftime(i.secondsFormat))}})},_preparePieItem:function(g,h){var a=this,f=a._circlesIds[a._circlesIds.length-1]+1;a._circlesIds.push(f);g.attr("id","hs-countdown-element-"+f);g.data("circle",Circles.create({id:"hs-countdown-element-"+f,radius:h.radius||80,value:0,maxValue:h.maxValue||100,width:h.width||10,text:function(c){return c+(h["additional-text"]||"")},colors:[h["bg-color"]||"#eeeeee",h["fg-color"]||"#72c02c"],duration:0,wrpClass:a.config.wrpClass,textClass:a.config.textClass,valueStrokeClass:a.config.valueStrokeClass,maxValueStrokeClass:a.config.maxValueStrokeClass,styleWrapper:a.config.styleWrapper,styleText:a.config.styleText}));if(h["font-size"]){g.find("."+a.config.textClass).css("font-size",h["font-size"]+"px")}},_getDaysMaxValByFormat:function(f,a,g){var h=24*60*60*1000;switch(f){case"%D":return Math.round(Math.abs((g.getTime()-a.getTime())/(h)));break;default:return 31}}}})(jQuery);